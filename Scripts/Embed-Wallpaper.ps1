<#
.SYNOPSIS
  Change windows wallpaper from embed Base64 String
.DESCRIPTION
  The image are stored at %UserProfile% folder with a GUID by name, change the desktop-wallpaper registry key and
  update the user profile.
  
  There is a reason to add multiple profile update commands: Windows doesnt update the profile all times.
  If you wait a little, the updating command will work, but if you are updated the profile recently its better repeat a few times.
.NOTES
  Version:        1.0
  Author:         Hacksturcon (G.R.G)
  Creation Date:  19/08/2018
.EXAMPLE
  Just run the script.
#>
$Embed = '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'
$Data = [System.Convert]::FromBase64String($Embed)
$File = "$($env:USERPROFILE)\"+[guid]::NewGuid().ToString()+".jpg"
Set-Content -Path $File -Value $Data -Encoding Byte
Set-ItemProperty -path 'HKCU:\Control Panel\Desktop\' -name wallpaper -value "$File"
rundll32.exe user32.dll, UpdatePerUserSystemParameters
rundll32.exe user32.dll, UpdatePerUserSystemParameters,0,True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 0, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters,1,True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 1, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 2, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters,2,True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 2, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 1, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters,1,True
rundll32.exe user32.dll, UpdatePerUserSystemParameters, 0, True
rundll32.exe user32.dll, UpdatePerUserSystemParameters,0,True
rundll32.exe user32.dll, UpdatePerUserSystemParameters
Exit
